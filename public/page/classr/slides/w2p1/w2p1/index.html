<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>dplyr (and a bit of checking in)</title>
  <meta property="og:title" content="dplyr (and a bit of checking in)" />
  <meta name="twitter:title" content="dplyr (and a bit of checking in)" />
  <meta name="description" content="em { font-style: italic }   strong { font-weight: bold; }  First things first: Cool stuff share! A bit of background on my pick  Equations within RMD look beautiful, but can be a pain  Must use \LaTeX (see examples here: http://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html)    
 My pick: mathpix  See https://github.com/jonocarroll/mathpix   Generally works well regardless of surface (demo following)
 Others? Tidyverse: Providing a grammar for&hellip;  Graphics (ggplot) Data manipulations (dplyr, tidyr) Ever expanding specialized topics (not quite modeling yet, although there is some)  dplyr: A grammar for data wrangling Take a guess - what do you think the following do?">
  <meta property="og:description" content="em { font-style: italic }   strong { font-weight: bold; }  First things first: Cool stuff share! A bit of background on my pick  Equations within RMD look beautiful, but can be a pain  Must use \LaTeX (see examples here: http://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html)    
 My pick: mathpix  See https://github.com/jonocarroll/mathpix   Generally works well regardless of surface (demo following)
 Others? Tidyverse: Providing a grammar for&hellip;  Graphics (ggplot) Data manipulations (dplyr, tidyr) Ever expanding specialized topics (not quite modeling yet, although there is some)  dplyr: A grammar for data wrangling Take a guess - what do you think the following do?">
  <meta name="twitter:description" content="em { font-style: italic }   strong { font-weight: bold; }  First things first: Cool stuff share! A bit of background on my pick  Equations within RMD look beautiful, but can be a pain  Must use \LaTeX â€¦">
  <meta name="author" content="Daniel Anderson"/>
  <meta property="og:image" content="/img/scatter.png" />
  <meta name="twitter:image" content="/img/scatter.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@DJAnderson_07" />
  <meta name="twitter:creator" content="@DJAnderson_07" />
  <meta property="og:url" content="/page/classr/slides/w2p1/w2p1/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Data Science in Education" />

  <meta name="generator" content="Hugo 0.24.1" />
  <link rel="canonical" href="/page/classr/slides/w2p1/w2p1/" />
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Data Science in Education">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="/css/pygment_highlights.css" />
  <link rel="stylesheet" href="/css/highlight.min.css" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Data Science in Education</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">esvis</a>
              <div class="navlinks-children">
                
                  <a href="/post/esvis-part-1">Introduction to the esvis package</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Vita</a>
              <div class="navlinks-children">
                
                  <a href="/page/conference_pres">conference presentations</a>
                
                  <a href="/page/publications">publications</a>
                
                  <a href="/page/software">software</a>
                
                  <a href="/page/teaching">teaching</a>
                
              </div>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Data Science in Education" href="/">
            <img class="avatar-img" src="/img/scatter.png" alt="Data Science in Education" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>dplyr (and a bit of checking in)</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<style>
em {
  font-style: italic
}
</style>

<style>
strong {
  font-weight: bold;
}
</style>

<h2 id="first-things-first-cool-stuff-share">First things first: Cool stuff share!</h2>

<h1 id="a-bit-of-background-on-my-pick">A bit of background on my pick</h1>

<ul>
<li>Equations within RMD look beautiful, but can be a pain

<ul>
<li>Must use \LaTeX (see examples here: <a href="http://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html">http://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html</a>)
<br /></li>
</ul></li>
</ul>

<p><br></p>

<div align = "center">
<img src = ../assets/img/latex.png width = 800 height = 500>
</div>

<hr />

<h1 id="my-pick-mathpix">My pick: mathpix</h1>

<ul>
<li>See <a href="https://github.com/jonocarroll/mathpix">https://github.com/jonocarroll/mathpix</a>
<br></li>
</ul>

<p><img src="../assets/img/mathpix.png" alt="mathpix" /></p>

<hr />

<h2 id="generally-works-well-regardless-of-surface">Generally works well regardless of surface</h2>

<p>(demo following)</p>

<div align = "center">
<img src = ../assets/img/tats.png width = 800 height = 500>
</div>

<hr />

<h1 id="others">Others?</h1>

<hr />

<h2 id="tidyverse-providing-a-grammar-for">Tidyverse: Providing a grammar for&hellip;</h2>

<ul>
<li>Graphics (<em>ggplot</em>)</li>
<li>Data manipulations (<em>dplyr</em>, <em>tidyr</em>)</li>
<li>Ever expanding specialized topics (not quite modeling yet, although there is some)</li>
</ul>

<hr />

<h2 id="dplyr-a-grammar-for-data-wrangling">dplyr: A grammar for data wrangling</h2>

<p>Take a guess - what do you think the following do? Discuss with your neighbor.</p>

<ul>
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>mutate()</code></li>
<li><code>arrange()</code></li>
<li><code>summarize()</code></li>
<li><code>group_by()</code></li>
</ul>

<div align = "right">
<img src = ../assets/img/dplyr_hex.png width = 200 height = 200>
</div>

<hr />

<h2 id="dplyr-a-grammar-for-data-wrangling-1">dplyr: A grammar for data wrangling</h2>

<ul>
<li><code>select()</code>: A subset of columns</li>
<li><code>filter()</code>: A subset of rows</li>
<li><code>mutate()</code>: Add or modify existing columns</li>
<li><code>arrange()</code>: Rows in a ascending or descending order</li>
<li><code>summarize()</code>: A variable according to other functions (e.g., <code>mean()</code>, <code>sd()</code>). Often used in conjunction with <code>group_by()</code></li>
</ul>

<div align = "right">
<img src = ../assets/img/dplyr_hex.png width = 300 height = 300>
</div>

<hr />

<h2 id="janitor-cleaning-up-common-dirt">janitor: Cleaning up common dirt</h2>

<p>Little easier (minus maybe the first one). Guess what these do?</p>

<ul>
<li><code>clean_names()</code></li>
<li><code>remove_empty_rows()</code></li>
<li><code>remove_empty_cols()</code></li>
<li><code>excel_numeric_to_date()</code></li>
<li><code>get_dupes()</code></li>
<li><code>tabyl()</code></li>
<li><code>crosstabs()</code></li>
</ul>

<div align = "right">
<img src = ../assets/img/janitor_hex.png width = 200 height = 200>
</div>

<hr />

<h2 id="janitor-cleaning-up-common-dirt-1">janitor: Cleaning up common dirt</h2>

<p>Little easier (minus maybe the first one). Guess what these do?</p>

<ul>
<li><code>clean_names()</code>: Styles column names with snake_case</li>
<li><code>remove_empty_rows()</code>: Removes empty rows</li>
<li><code>remove_empty_cols()</code>: Removes empty columns</li>
<li><code>excel_numeric_to_date()</code>: Changes numeric dates imported from Excel to actual dates</li>
<li><code>get_dupes()</code>: Provides duplicates for any variable(s) provided</li>
<li><code>tabyl()</code>: Frequncies. Similar to <code>dplyr::count()</code></li>
<li><code>crosstabs()</code>: Cross-tabulation table.</li>
</ul>

<p>There are also <code>adorn_*()</code> to spruce up the last two.</p>

<hr />

<h2 id="examples-from-janitor-readme">Examples from janitor README</h2>

<p>Import the data (first start a new project, and put the data in a data folder, then..)</p>

<ul>
<li>Note the optional <code>setclass</code> argument here to set everything to a tibble,
rather than a standard data frame, which has much nicer printing methods.</li>
</ul>

<pre><code class="language-r">library(rio)
dirty &lt;- import(&quot;./data/dirty_data.xlsx&quot;, setclass = &quot;tbl_df&quot;)
dirty
</code></pre>

<pre><code>## # A tibble: 13 x 11
##    `First Name` `Last Name` `Employee Status`    Subject `Hire Date`
##           &lt;chr&gt;       &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt;
##  1        Jason      Bourne           Teacher         PE       39690
##  2        Jason      Bourne           Teacher   Drafting       39690
##  3       Alicia        Keys           Teacher      Music       37118
##  4          Ada    Lovelace           Teacher       &lt;NA&gt;       27515
##  5        Desus        Nice    Administration       Dean       41431
##  6 Chien-Shiung          Wu           Teacher    Physics       11037
##  7 Chien-Shiung          Wu           Teacher  Chemistry       11037
##  8         &lt;NA&gt;        &lt;NA&gt;              &lt;NA&gt;       &lt;NA&gt;          NA
##  9        James       Joyce           Teacher    English       32994
## 10         Hedy      Lamarr           Teacher    Science       27919
## 11       Carlos      Boozer             Coach Basketball       42221
## 12        Young      Boozer             Coach       &lt;NA&gt;       34700
## 13      Micheal      Larsen           Teacher    English       40071
## # ... with 6 more variables: `% Allocated` &lt;dbl&gt;, `Full time?` &lt;chr&gt;, `do
## #   not edit! ---&gt;` &lt;lgl&gt;, Certification &lt;chr&gt;, Certification__1 &lt;chr&gt;,
## #   Certification__2 &lt;lgl&gt;
</code></pre>

<hr />

<h2 id="clean-names"><code>clean_names()</code></h2>

<ul>
<li>Function I use the most. I <em>really</em> recommend getting in the habit of sticking with a consistent style, and if that style is snake_case, then this is a great helper function.</li>
</ul>

<pre><code class="language-r">library(janitor)
clean_names(dirty)
</code></pre>

<pre><code>## # A tibble: 13 x 11
##      first_name last_name employee_status    subject hire_date
##           &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
##  1        Jason    Bourne         Teacher         PE     39690
##  2        Jason    Bourne         Teacher   Drafting     39690
##  3       Alicia      Keys         Teacher      Music     37118
##  4          Ada  Lovelace         Teacher       &lt;NA&gt;     27515
##  5        Desus      Nice  Administration       Dean     41431
##  6 Chien-Shiung        Wu         Teacher    Physics     11037
##  7 Chien-Shiung        Wu         Teacher  Chemistry     11037
##  8         &lt;NA&gt;      &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;        NA
##  9        James     Joyce         Teacher    English     32994
## 10         Hedy    Lamarr         Teacher    Science     27919
## 11       Carlos    Boozer           Coach Basketball     42221
## 12        Young    Boozer           Coach       &lt;NA&gt;     34700
## 13      Micheal    Larsen         Teacher    English     40071
## # ... with 6 more variables: percent_allocated &lt;dbl&gt;, full_time &lt;chr&gt;,
## #   do_not_edit &lt;lgl&gt;, certification &lt;chr&gt;, certification_1 &lt;chr&gt;,
## #   certification_2 &lt;lgl&gt;
</code></pre>

<hr />

<ul>
<li>Because the janitor functions are relatively straightforward, we&rsquo;ll move on to dplyr. But we&rsquo;ll be using <em>janitor</em> fairly frequently throughout the term.</li>
<li>Good habit to get into:

<ul>
<li>import data</li>
<li>clean names</li>
<li>remove empty rows</li>
<li>remove empty columns</li>
</ul></li>
</ul>

<hr />

<h1 id="dplyr">dplyr</h1>

<hr />

<h2 id="arguments">Arguments</h2>

<ul>
<li><em>dplyr</em> always takes a data frame as the first argument.</li>
<li>Subsequent argument tell <em>dplyr</em> what to do with the data frame.</li>
<li>Returns the modified data frame</li>
</ul>

<hr />

<h2 id="select"><code>select()</code></h2>

<div align = "center">
<img src = ../assets/img/select.png width = 1000 height = 400>
</div>

<p><br></p>

<p><span style="color:gray">(Figure from Baumer, Kaplan, &amp; Horton, 2017)</span></p>

<hr />

<h2 id="filter"><code>filter()</code></h2>

<div align = "center">
<img src = ../assets/img/filter.png width = 1000 height = 400>
</div>

<p><br></p>

<p><span style="color:gray">(Figure from Baumer, Kaplan, &amp; Horton, 2017)</span></p>

<hr />

<h2 id="examples-follow-along">Examples (follow along!)</h2>

<p>We&rsquo;ll start with the presidential dataset from the <em>mdsr</em> package.</p>

<pre><code class="language-r">install.packages(&quot;mdsr&quot;)
library(mdsr)
presidential
</code></pre>

<table>
<thead>
<tr>
<th align="left">name</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="left">party</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Eisenhower</td>
<td align="left">1953-01-20</td>
<td align="left">1961-01-20</td>
<td align="left">Republican</td>
</tr>

<tr>
<td align="left">Kennedy</td>
<td align="left">1961-01-20</td>
<td align="left">1963-11-22</td>
<td align="left">Democratic</td>
</tr>

<tr>
<td align="left">Johnson</td>
<td align="left">1963-11-22</td>
<td align="left">1969-01-20</td>
<td align="left">Democratic</td>
</tr>

<tr>
<td align="left">Nixon</td>
<td align="left">1969-01-20</td>
<td align="left">1974-08-09</td>
<td align="left">Republican</td>
</tr>

<tr>
<td align="left">Ford</td>
<td align="left">1974-08-09</td>
<td align="left">1977-01-20</td>
<td align="left">Republican</td>
</tr>

<tr>
<td align="left">Carter</td>
<td align="left">1977-01-20</td>
<td align="left">1981-01-20</td>
<td align="left">Democratic</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="select-president-name-and-party">Select president name and party</h2>

<pre><code class="language-r">select(presidential, name, party)
</code></pre>

<pre><code>## # A tibble: 11 x 2
##          name      party
##         &lt;chr&gt;      &lt;chr&gt;
##  1 Eisenhower Republican
##  2    Kennedy Democratic
##  3    Johnson Democratic
##  4      Nixon Republican
##  5       Ford Republican
##  6     Carter Democratic
##  7     Reagan Republican
##  8       Bush Republican
##  9    Clinton Democratic
## 10       Bush Republican
## 11      Obama Democratic
</code></pre>

<hr />

<h2 id="use-negation">Use negation</h2>

<pre><code class="language-r">select(presidential, -start)
</code></pre>

<pre><code>## # A tibble: 11 x 3
##          name        end      party
##         &lt;chr&gt;     &lt;date&gt;      &lt;chr&gt;
##  1 Eisenhower 1961-01-20 Republican
##  2    Kennedy 1963-11-22 Democratic
##  3    Johnson 1969-01-20 Democratic
##  4      Nixon 1974-08-09 Republican
##  5       Ford 1977-01-20 Republican
##  6     Carter 1981-01-20 Democratic
##  7     Reagan 1989-01-20 Republican
##  8       Bush 1993-01-20 Republican
##  9    Clinton 2001-01-20 Democratic
## 10       Bush 2009-01-20 Republican
## 11      Obama 2017-01-20 Democratic
</code></pre>

<hr />

<h2 id="use-indexing">Use indexing</h2>

<pre><code class="language-r">select(presidential, 1:3)
</code></pre>

<pre><code>## # A tibble: 11 x 3
##          name      start        end
##         &lt;chr&gt;     &lt;date&gt;     &lt;date&gt;
##  1 Eisenhower 1953-01-20 1961-01-20
##  2    Kennedy 1961-01-20 1963-11-22
##  3    Johnson 1963-11-22 1969-01-20
##  4      Nixon 1969-01-20 1974-08-09
##  5       Ford 1974-08-09 1977-01-20
##  6     Carter 1977-01-20 1981-01-20
##  7     Reagan 1981-01-20 1989-01-20
##  8       Bush 1989-01-20 1993-01-20
##  9    Clinton 1993-01-20 2001-01-20
## 10       Bush 2001-01-20 2009-01-20
## 11      Obama 2009-01-20 2017-01-20
</code></pre>

<hr />

<h2 id="select-helper-funs"><code>select()</code> helper funs</h2>

<ul>
<li><code>starts_with()</code></li>
<li><code>ends_with()</code></li>
<li><code>contains()</code></li>
<li><code>matches()</code></li>
<li><code>num_range()</code></li>
</ul>

<hr />

<h2 id="project-reads-data">Project Reads data</h2>

<pre><code class="language-r">reads &lt;- import(&quot;./data/Project_Reads_Scores.csv&quot;, setclass = &quot;tbl_df&quot;)
reads &lt;- clean_names(reads)
reads
</code></pre>

<pre><code>## # A tibble: 48 x 25
##                 test_year test_type test_site student_id pre_test_score
##                     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;          &lt;int&gt;
##  1 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 1             43
##  2 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 2             46
##  3 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 3             39
##  4 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 4             35
##  5 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 5             46
##  6 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 6             35
##  7 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 7             40
##  8 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 8             39
##  9 06/01/2016 12:00:00 AM  YEAR END    VIRDEN   Virden 9             40
## 10 06/01/2016 12:00:00 AM  YEAR END    VIRDEN  Virden 10             45
## # ... with 38 more rows, and 20 more variables: pre_test_percent &lt;chr&gt;,
## #   post_test_score &lt;int&gt;, post_test_percent &lt;chr&gt;,
## #   percentage_change &lt;chr&gt;, unit_1_score &lt;int&gt;, unit_1_percent &lt;chr&gt;,
## #   unit_2_score &lt;int&gt;, unit_2_percent &lt;chr&gt;, unit_3_score &lt;int&gt;,
## #   unit_3_percent &lt;chr&gt;, unit_4_score &lt;int&gt;, unit_4_percent &lt;chr&gt;,
## #   unit_5_6_score &lt;int&gt;, unit_5_6_percent &lt;chr&gt;, unit_7_score &lt;int&gt;,
## #   unit_7_percent &lt;chr&gt;, unit_8_score &lt;int&gt;, unit_8_percent &lt;chr&gt;,
## #   total_score &lt;int&gt;, total_percent_correct &lt;chr&gt;
</code></pre>

<hr />

<h2 id="starts-with"><code>starts_with</code></h2>

<pre><code class="language-r">select(reads, starts_with(&quot;test&quot;))
</code></pre>

<pre><code>## # A tibble: 48 x 3
##                 test_year test_type test_site
##                     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;
##  1 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  2 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  3 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  4 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  5 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  6 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  7 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  8 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
##  9 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
## 10 06/01/2016 12:00:00 AM  YEAR END    VIRDEN
## # ... with 38 more rows
</code></pre>

<hr />

<h2 id="ends-with"><code>ends_with</code></h2>

<pre><code class="language-r">select(reads, ends_with(&quot;score&quot;))
</code></pre>

<pre><code>## # A tibble: 48 x 10
##    pre_test_score post_test_score unit_1_score unit_2_score unit_3_score
##             &lt;int&gt;           &lt;int&gt;        &lt;int&gt;        &lt;int&gt;        &lt;int&gt;
##  1             43              92            3            4            6
##  2             46             104            5            5            6
##  3             39              75            4            4            6
##  4             35             115            4            4            6
##  5             46              85            2            5            6
##  6             35              91            5            5            7
##  7             40              96            5            5            6
##  8             39              74            4            5            5
##  9             40              90            6            4            5
## 10             45              86            4            5            5
## # ... with 38 more rows, and 5 more variables: unit_4_score &lt;int&gt;,
## #   unit_5_6_score &lt;int&gt;, unit_7_score &lt;int&gt;, unit_8_score &lt;int&gt;,
## #   total_score &lt;int&gt;
</code></pre>

<hr />

<h2 id="contains"><code>contains</code></h2>

<pre><code class="language-r">select(reads, contains(&quot;test&quot;))
</code></pre>

<pre><code>## # A tibble: 48 x 7
##                 test_year test_type test_site pre_test_score
##                     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;
##  1 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             43
##  2 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             46
##  3 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             39
##  4 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             35
##  5 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             46
##  6 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             35
##  7 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             40
##  8 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             39
##  9 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             40
## 10 06/01/2016 12:00:00 AM  YEAR END    VIRDEN             45
## # ... with 38 more rows, and 3 more variables: pre_test_percent &lt;chr&gt;,
## #   post_test_score &lt;int&gt;, post_test_percent &lt;chr&gt;
</code></pre>

<hr />

<h2 id="matches"><code>matches</code></h2>

<p>Matches a regular expression (here, contains a digit))</p>

<pre><code class="language-r">select(reads, matches(&quot;\\d&quot;))
</code></pre>

<pre><code>## # A tibble: 48 x 14
##    unit_1_score unit_1_percent unit_2_score unit_2_percent unit_3_score
##           &lt;int&gt;          &lt;chr&gt;        &lt;int&gt;          &lt;chr&gt;        &lt;int&gt;
##  1            3            12%            4            16%            6
##  2            5            20%            5            20%            6
##  3            4            16%            4            16%            6
##  4            4            16%            4            16%            6
##  5            2             8%            5            20%            6
##  6            5            20%            5            20%            7
##  7            5            20%            5            20%            6
##  8            4            16%            5            20%            5
##  9            6            24%            4            16%            5
## 10            4            16%            5            20%            5
## # ... with 38 more rows, and 9 more variables: unit_3_percent &lt;chr&gt;,
## #   unit_4_score &lt;int&gt;, unit_4_percent &lt;chr&gt;, unit_5_6_score &lt;int&gt;,
## #   unit_5_6_percent &lt;chr&gt;, unit_7_score &lt;int&gt;, unit_7_percent &lt;chr&gt;,
## #   unit_8_score &lt;int&gt;, unit_8_percent &lt;chr&gt;
</code></pre>

<hr />

<h2 id="num-range"><code>num_range</code></h2>

<p>Only works if the number is at the end of the column. So, first drop &ldquo;_score&rdquo;
from each of the score columns, then select units 2-4 and 7.</p>

<pre><code class="language-r">names(reads)[grep(&quot;score&quot;, names(reads))] &lt;- gsub(&quot;_score&quot;, &quot;&quot;, 
    names(reads)[grep(&quot;score&quot;, names(reads))])

select(reads, num_range(&quot;unit_&quot;, c(2:4, 7)))
</code></pre>

<pre><code>## # A tibble: 48 x 4
##    unit_2 unit_3 unit_4 unit_7
##     &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
##  1      4      6      8     22
##  2      5      6      8     20
##  3      4      6      9     19
##  4      4      6     10     18
##  5      5      6      7     19
##  6      5      7      7     23
##  7      5      6      7     21
##  8      5      5      8     16
##  9      4      5      8     18
## 10      5      5      7     21
## # ... with 38 more rows
</code></pre>

<hr />

<h2 id="last-thing-on-select">Last thing on <code>select</code></h2>

<p>You can mix types and helper funs. You can also use select to rearrange your columns.</p>

<pre><code class="language-r">select(reads, student_id, 1, starts_with(&quot;total&quot;))
</code></pre>

<pre><code>## # A tibble: 48 x 4
##    student_id              test_year total total_percent_correct
##         &lt;chr&gt;                  &lt;chr&gt; &lt;int&gt;                 &lt;chr&gt;
##  1   Virden 1 06/01/2016 12:00:00 AM   207                   41%
##  2   Virden 2 06/01/2016 12:00:00 AM   224                   45%
##  3   Virden 3 06/01/2016 12:00:00 AM   193                   39%
##  4   Virden 4 06/01/2016 12:00:00 AM   223                   45%
##  5   Virden 5 06/01/2016 12:00:00 AM   198                   40%
##  6   Virden 6 06/01/2016 12:00:00 AM   210                   42%
##  7   Virden 7 06/01/2016 12:00:00 AM   211                   42%
##  8   Virden 8 06/01/2016 12:00:00 AM   180                   36%
##  9   Virden 9 06/01/2016 12:00:00 AM   206                   41%
## 10  Virden 10 06/01/2016 12:00:00 AM   206                   41%
## # ... with 38 more rows
</code></pre>

<hr />

<h2 id="filter-boolean-logic"><code>filter()</code> boolean logic</h2>

<p>Left circle == x, right circle == y</p>

<div align = "center">
<img src = ../assets/img/filter_boolean.png width = 1000 height = 450>
</div>

<p><span style="color:gray">(Figure from Wickham &amp; Grolemund, 2017)</span></p>

<hr />

<h2 id="filter-for-democrats">filter for democrats</h2>

<pre><code class="language-r">filter(presidential, party == &quot;Democratic&quot;)
</code></pre>

<pre><code>## # A tibble: 5 x 4
##      name      start        end      party
##     &lt;chr&gt;     &lt;date&gt;     &lt;date&gt;      &lt;chr&gt;
## 1 Kennedy 1961-01-20 1963-11-22 Democratic
## 2 Johnson 1963-11-22 1969-01-20 Democratic
## 3  Carter 1977-01-20 1981-01-20 Democratic
## 4 Clinton 1993-01-20 2001-01-20 Democratic
## 5   Obama 2009-01-20 2017-01-20 Democratic
</code></pre>

<hr />

<h2 id="filter-for-dems-between-1970-and-2000">filter for dems between 1970 and 2000</h2>

<pre><code class="language-r">filter(presidential, party == &quot;Democratic&quot; &amp;
                     (start &gt; as.Date(&quot;1970-01-01&quot;) &amp;
                     start &lt; as.Date(&quot;2000-01-01&quot;)))
</code></pre>

<pre><code>## # A tibble: 2 x 4
##      name      start        end      party
##     &lt;chr&gt;     &lt;date&gt;     &lt;date&gt;      &lt;chr&gt;
## 1  Carter 1977-01-20 1981-01-20 Democratic
## 2 Clinton 1993-01-20 2001-01-20 Democratic
</code></pre>

<hr />

<h2 id="multiple-args-to-filter">Multiple args to filter</h2>

<ul>
<li>You can supply multiple arguments to filter and they will be stapled together with <code>&amp;</code>.</li>
<li>The below is equivalent to the code on the previous slide</li>
</ul>

<pre><code class="language-r">filter(presidential, party == &quot;Democratic&quot;,
                     start &gt; as.Date(&quot;1970-01-01&quot;),
                     start &lt; as.Date(&quot;2000-01-01&quot;))
</code></pre>

<pre><code>## # A tibble: 2 x 4
##      name      start        end      party
##     &lt;chr&gt;     &lt;date&gt;     &lt;date&gt;      &lt;chr&gt;
## 1  Carter 1977-01-20 1981-01-20 Democratic
## 2 Clinton 1993-01-20 2001-01-20 Democratic
</code></pre>

<hr />

<h2 id="chaining-arguments">Chaining arguments</h2>

<ul>
<li>What if we wanted to select and filter a dataset?</li>
<li>Select name and party of presidents who began their term after 2000</li>
</ul>

<p>Two step method</p>

<pre><code class="language-r">after_2000 &lt;- filter(presidential, start &gt; as.Date(&quot;2000-01-01&quot;))
select(after_2000, name, party)
</code></pre>

<pre><code>## # A tibble: 2 x 2
##    name      party
##   &lt;chr&gt;      &lt;chr&gt;
## 1  Bush Republican
## 2 Obama Democratic
</code></pre>

<hr />

<h2 id="chaining-arguments-1">Chaining arguments</h2>

<ul>
<li>Alternatively, we could wrap <code>select</code> around <code>filter</code></li>
</ul>

<pre><code class="language-r">select(filter(presidential, start &gt; as.Date(&quot;2000-01-01&quot;)), name, party)
</code></pre>

<pre><code>## # A tibble: 2 x 2
##    name      party
##   &lt;chr&gt;      &lt;chr&gt;
## 1  Bush Republican
## 2 Obama Democratic
</code></pre>

<hr />

<h2 id="chaining-arguments-2">Chaining arguments</h2>

<ul>
<li>Or, we could use another function to help increase the readability of our code: <code>%&gt;%</code></li>
<li>Called the &ldquo;pipe&rdquo; operator and &ldquo;piping functions&rdquo;</li>
</ul>

<pre><code class="language-r">filter(presidential, start &gt; as.Date(&quot;2000-01-01&quot;)) %&gt;% 
  select(name, party)
</code></pre>

<pre><code>## # A tibble: 2 x 2
##    name      party
##   &lt;chr&gt;      &lt;chr&gt;
## 1  Bush Republican
## 2 Obama Democratic
</code></pre>

<hr />

<h2 id="chaining-arguments-3">Chaining arguments</h2>

<p>Generally when using the pipe, the first argument is the dataset, which gets piped through the corresponding functions. So the code on the prior slide would more typically be written</p>

<pre><code class="language-r">presidential %&gt;% 
  filter(start &gt; as.Date(&quot;2000-01-01&quot;)) %&gt;% 
  select(name, party)
</code></pre>

<pre><code>## # A tibble: 2 x 2
##    name      party
##   &lt;chr&gt;      &lt;chr&gt;
## 1  Bush Republican
## 2 Obama Democratic
</code></pre>

<p>Note the indentation and line breaks to help keep things straight.</p>

<hr />

<h2 id="your-turn">Your turn</h2>

<ul>
<li>Install and load the package <em>Lahman</em>, which will give you access to the dataset <em>Teams</em></li>
</ul>

<pre><code class="language-r">install.packages(&quot;Lahman&quot;)
library(Lahman)
head(Teams)
</code></pre>

<ul>
<li>Using piping, produce a subset of the data that has the following characteristics:

<ul>
<li>Only one team (your choice)</li>
<li>data from 1980 to present (or as present as the dataset gets)</li>
<li>Includes 5 columns: name, yearID, W, L, R, RA</li>
</ul></li>
</ul>

<p>(The variables above correspond to the team name, the year, wins, losses, runs scored, and runs allowed)
* Make sure you select a team that is currently still around, or it probably won&rsquo;t be interesting.</p>

<hr />

<h2 id="baseball-data-example">Baseball data example</h2>

<p>(one possible method)</p>

<pre><code class="language-r">teams &lt;- Teams %&gt;% 
  clean_names()

cubs &lt;- teams %&gt;% 
    filter(name == &quot;Chicago Cubs&quot; &amp; yearid &gt;= 1980) %&gt;% 
    select(name, yearid, w, l, r, ra)
cubs
</code></pre>

<pre><code>##            name yearid   w   l   r  ra
## 1  Chicago Cubs   1980  64  98 614 728
## 2  Chicago Cubs   1981  38  65 370 483
## 3  Chicago Cubs   1982  73  89 676 709
## 4  Chicago Cubs   1983  71  91 701 719
## 5  Chicago Cubs   1984  96  65 762 658
## 6  Chicago Cubs   1985  77  84 686 729
## 7  Chicago Cubs   1986  70  90 680 781
## 8  Chicago Cubs   1987  76  85 720 801
## 9  Chicago Cubs   1988  77  85 660 694
## 10 Chicago Cubs   1989  93  69 702 623
## 11 Chicago Cubs   1990  77  85 690 774
## 12 Chicago Cubs   1991  77  83 695 734
## 13 Chicago Cubs   1992  78  84 593 624
## 14 Chicago Cubs   1993  84  78 738 739
## 15 Chicago Cubs   1994  49  64 500 549
## 16 Chicago Cubs   1995  73  71 693 671
## 17 Chicago Cubs   1996  76  86 772 771
## 18 Chicago Cubs   1997  68  94 687 759
## 19 Chicago Cubs   1998  90  73 831 792
## 20 Chicago Cubs   1999  67  95 747 920
## 21 Chicago Cubs   2000  65  97 764 904
## 22 Chicago Cubs   2001  88  74 777 701
## 23 Chicago Cubs   2002  67  95 706 759
## 24 Chicago Cubs   2003  88  74 724 683
## 25 Chicago Cubs   2004  89  73 789 665
## 26 Chicago Cubs   2005  79  83 703 714
## 27 Chicago Cubs   2006  66  96 716 834
## 28 Chicago Cubs   2007  85  77 752 690
## 29 Chicago Cubs   2008  97  64 855 671
## 30 Chicago Cubs   2009  83  78 707 672
## 31 Chicago Cubs   2010  75  87 685 767
## 32 Chicago Cubs   2011  71  91 654 756
## 33 Chicago Cubs   2012  61 101 613 759
## 34 Chicago Cubs   2013  66  96 602 689
## 35 Chicago Cubs   2014  73  89 614 707
## 36 Chicago Cubs   2015  97  65 689 608
## 37 Chicago Cubs   2016 103  58 808 556
</code></pre>

<hr />

<h2 id="quick-aside">Quick Aside</h2>

<p>Time series plot (where we&rsquo;re heading)</p>

<pre><code class="language-r">library(ggplot2)
ggplot(cubs, aes(yearid, w)) + 
  geom_line() +
  geom_smooth()
</code></pre>

<p><img src="../assets/fig/time_series-1.png" alt="plot of chunk time_series" /></p>

<hr />

<h2 id="finishing-up-with-dplyr">Finishing up with <em>dplyr</em></h2>

<ul>
<li>Create a new variable</li>
</ul>

<p>Let&rsquo;s compute the winning percentage for the team you chose over time</p>

<p>$$w_{pct} = \frac{wins}{wins + losses}$$</p>

<pre><code class="language-r">cubs &lt;- cubs %&gt;% 
    mutate(w_pct = w / (w + l))

cubs
</code></pre>

<pre><code>##            name yearid   w   l   r  ra     w_pct
## 1  Chicago Cubs   1980  64  98 614 728 0.3950617
## 2  Chicago Cubs   1981  38  65 370 483 0.3689320
## 3  Chicago Cubs   1982  73  89 676 709 0.4506173
## 4  Chicago Cubs   1983  71  91 701 719 0.4382716
## 5  Chicago Cubs   1984  96  65 762 658 0.5962733
## 6  Chicago Cubs   1985  77  84 686 729 0.4782609
## 7  Chicago Cubs   1986  70  90 680 781 0.4375000
## 8  Chicago Cubs   1987  76  85 720 801 0.4720497
## 9  Chicago Cubs   1988  77  85 660 694 0.4753086
## 10 Chicago Cubs   1989  93  69 702 623 0.5740741
## 11 Chicago Cubs   1990  77  85 690 774 0.4753086
## 12 Chicago Cubs   1991  77  83 695 734 0.4812500
## 13 Chicago Cubs   1992  78  84 593 624 0.4814815
## 14 Chicago Cubs   1993  84  78 738 739 0.5185185
## 15 Chicago Cubs   1994  49  64 500 549 0.4336283
## 16 Chicago Cubs   1995  73  71 693 671 0.5069444
## 17 Chicago Cubs   1996  76  86 772 771 0.4691358
## 18 Chicago Cubs   1997  68  94 687 759 0.4197531
## 19 Chicago Cubs   1998  90  73 831 792 0.5521472
## 20 Chicago Cubs   1999  67  95 747 920 0.4135802
## 21 Chicago Cubs   2000  65  97 764 904 0.4012346
## 22 Chicago Cubs   2001  88  74 777 701 0.5432099
## 23 Chicago Cubs   2002  67  95 706 759 0.4135802
## 24 Chicago Cubs   2003  88  74 724 683 0.5432099
## 25 Chicago Cubs   2004  89  73 789 665 0.5493827
## 26 Chicago Cubs   2005  79  83 703 714 0.4876543
## 27 Chicago Cubs   2006  66  96 716 834 0.4074074
## 28 Chicago Cubs   2007  85  77 752 690 0.5246914
## 29 Chicago Cubs   2008  97  64 855 671 0.6024845
## 30 Chicago Cubs   2009  83  78 707 672 0.5155280
## 31 Chicago Cubs   2010  75  87 685 767 0.4629630
## 32 Chicago Cubs   2011  71  91 654 756 0.4382716
## 33 Chicago Cubs   2012  61 101 613 759 0.3765432
## 34 Chicago Cubs   2013  66  96 602 689 0.4074074
## 35 Chicago Cubs   2014  73  89 614 707 0.4506173
## 36 Chicago Cubs   2015  97  65 689 608 0.5987654
## 37 Chicago Cubs   2016 103  58 808 556 0.6397516
</code></pre>

<hr />

<h2 id="order-by-winning-percentage-least-to-greatest">Order by winning percentage: Least to greatest</h2>

<pre><code class="language-r">cubs %&gt;% arrange(w_pct)
</code></pre>

<pre><code>##            name yearid   w   l   r  ra     w_pct
## 1  Chicago Cubs   1981  38  65 370 483 0.3689320
## 2  Chicago Cubs   2012  61 101 613 759 0.3765432
## 3  Chicago Cubs   1980  64  98 614 728 0.3950617
## 4  Chicago Cubs   2000  65  97 764 904 0.4012346
## 5  Chicago Cubs   2006  66  96 716 834 0.4074074
## 6  Chicago Cubs   2013  66  96 602 689 0.4074074
## 7  Chicago Cubs   1999  67  95 747 920 0.4135802
## 8  Chicago Cubs   2002  67  95 706 759 0.4135802
## 9  Chicago Cubs   1997  68  94 687 759 0.4197531
## 10 Chicago Cubs   1994  49  64 500 549 0.4336283
## 11 Chicago Cubs   1986  70  90 680 781 0.4375000
## 12 Chicago Cubs   1983  71  91 701 719 0.4382716
## 13 Chicago Cubs   2011  71  91 654 756 0.4382716
## 14 Chicago Cubs   1982  73  89 676 709 0.4506173
## 15 Chicago Cubs   2014  73  89 614 707 0.4506173
## 16 Chicago Cubs   2010  75  87 685 767 0.4629630
## 17 Chicago Cubs   1996  76  86 772 771 0.4691358
## 18 Chicago Cubs   1987  76  85 720 801 0.4720497
## 19 Chicago Cubs   1988  77  85 660 694 0.4753086
## 20 Chicago Cubs   1990  77  85 690 774 0.4753086
## 21 Chicago Cubs   1985  77  84 686 729 0.4782609
## 22 Chicago Cubs   1991  77  83 695 734 0.4812500
## 23 Chicago Cubs   1992  78  84 593 624 0.4814815
## 24 Chicago Cubs   2005  79  83 703 714 0.4876543
## 25 Chicago Cubs   1995  73  71 693 671 0.5069444
## 26 Chicago Cubs   2009  83  78 707 672 0.5155280
## 27 Chicago Cubs   1993  84  78 738 739 0.5185185
## 28 Chicago Cubs   2007  85  77 752 690 0.5246914
## 29 Chicago Cubs   2001  88  74 777 701 0.5432099
## 30 Chicago Cubs   2003  88  74 724 683 0.5432099
## 31 Chicago Cubs   2004  89  73 789 665 0.5493827
## 32 Chicago Cubs   1998  90  73 831 792 0.5521472
## 33 Chicago Cubs   1989  93  69 702 623 0.5740741
## 34 Chicago Cubs   1984  96  65 762 658 0.5962733
## 35 Chicago Cubs   2015  97  65 689 608 0.5987654
## 36 Chicago Cubs   2008  97  64 855 671 0.6024845
## 37 Chicago Cubs   2016 103  58 808 556 0.6397516
</code></pre>

<hr />

<h2 id="order-by-winning-percentage-greatest-to-least">Order by winning percentage: greatest to least</h2>

<pre><code class="language-r">cubs %&gt;% arrange(desc(w_pct))
</code></pre>

<pre><code>##            name yearid   w   l   r  ra     w_pct
## 1  Chicago Cubs   2016 103  58 808 556 0.6397516
## 2  Chicago Cubs   2008  97  64 855 671 0.6024845
## 3  Chicago Cubs   2015  97  65 689 608 0.5987654
## 4  Chicago Cubs   1984  96  65 762 658 0.5962733
## 5  Chicago Cubs   1989  93  69 702 623 0.5740741
## 6  Chicago Cubs   1998  90  73 831 792 0.5521472
## 7  Chicago Cubs   2004  89  73 789 665 0.5493827
## 8  Chicago Cubs   2001  88  74 777 701 0.5432099
## 9  Chicago Cubs   2003  88  74 724 683 0.5432099
## 10 Chicago Cubs   2007  85  77 752 690 0.5246914
## 11 Chicago Cubs   1993  84  78 738 739 0.5185185
## 12 Chicago Cubs   2009  83  78 707 672 0.5155280
## 13 Chicago Cubs   1995  73  71 693 671 0.5069444
## 14 Chicago Cubs   2005  79  83 703 714 0.4876543
## 15 Chicago Cubs   1992  78  84 593 624 0.4814815
## 16 Chicago Cubs   1991  77  83 695 734 0.4812500
## 17 Chicago Cubs   1985  77  84 686 729 0.4782609
## 18 Chicago Cubs   1988  77  85 660 694 0.4753086
## 19 Chicago Cubs   1990  77  85 690 774 0.4753086
## 20 Chicago Cubs   1987  76  85 720 801 0.4720497
## 21 Chicago Cubs   1996  76  86 772 771 0.4691358
## 22 Chicago Cubs   2010  75  87 685 767 0.4629630
## 23 Chicago Cubs   1982  73  89 676 709 0.4506173
## 24 Chicago Cubs   2014  73  89 614 707 0.4506173
## 25 Chicago Cubs   1983  71  91 701 719 0.4382716
## 26 Chicago Cubs   2011  71  91 654 756 0.4382716
## 27 Chicago Cubs   1986  70  90 680 781 0.4375000
## 28 Chicago Cubs   1994  49  64 500 549 0.4336283
## 29 Chicago Cubs   1997  68  94 687 759 0.4197531
## 30 Chicago Cubs   1999  67  95 747 920 0.4135802
## 31 Chicago Cubs   2002  67  95 706 759 0.4135802
## 32 Chicago Cubs   2006  66  96 716 834 0.4074074
## 33 Chicago Cubs   2013  66  96 602 689 0.4074074
## 34 Chicago Cubs   2000  65  97 764 904 0.4012346
## 35 Chicago Cubs   1980  64  98 614 728 0.3950617
## 36 Chicago Cubs   2012  61 101 613 759 0.3765432
## 37 Chicago Cubs   1981  38  65 370 483 0.3689320
</code></pre>

<hr />

<h2 id="summarize"><code>summarize</code></h2>

<ul>
<li>Compute the mean and standard deviation of winning percentage</li>
</ul>

<pre><code class="language-r">cubs %&gt;% 
    summarize(mean_winning_pct = mean(w_pct),
              sd_winning_pct = sd(w_pct))
</code></pre>

<pre><code>##   mean_winning_pct sd_winning_pct
## 1        0.4811027     0.06864337
</code></pre>

<hr />

<h2 id="group-by"><code>group_by</code></h2>

<ul>
<li>Conduct an operation <em>by</em> each level of a grouping factor</li>
</ul>

<p>Compute average wins for each team</p>

<pre><code class="language-r">teams %&gt;% 
    group_by(name) %&gt;% 
    summarize(av_wins = mean(w, na.rm = TRUE))
</code></pre>

<pre><code>## # A tibble: 139 x 2
##                     name  av_wins
##                    &lt;chr&gt;    &lt;dbl&gt;
##  1 Altoona Mountain City  6.00000
##  2        Anaheim Angels 83.00000
##  3  Arizona Diamondbacks 79.10526
##  4        Atlanta Braves 81.84314
##  5    Baltimore Canaries 26.00000
##  6   Baltimore Marylands  0.00000
##  7 Baltimore Monumentals 58.00000
##  8     Baltimore Orioles 76.87952
##  9   Baltimore Terrapins 65.50000
## 10      Boston Americans 75.42857
## # ... with 129 more rows
</code></pre>

<hr />

<h2 id="putting-it-all-together">Putting it all together</h2>

<ul>
<li>Move back to full dataset</li>
<li>Use  <code>group_by</code> in conjunction with <code>summary</code> to

<ul>
<li>compute the average and standard deviation of winning percentage for each team.</li>
</ul></li>
<li>Order by highest winning percentage</li>
</ul>

<hr />

<pre><code class="language-r">teams %&gt;% 
  mutate(w_pct = w / (w + l)) %&gt;% 
  group_by(name) %&gt;% 
  summarize(n = n(),
            mean_winning_pct = mean(w_pct, na.rm = TRUE),
            sd_winning_pct = sd(w_pct, na.rm = TRUE)) %&gt;% 
  arrange(desc(mean_winning_pct))
</code></pre>

<hr />

<pre><code>## # A tibble: 139 x 4
##                        name     n mean_winning_pct sd_winning_pct
##                       &lt;chr&gt; &lt;int&gt;            &lt;dbl&gt;          &lt;dbl&gt;
##  1     Boston Red Stockings     5        0.7733718     0.09110570
##  2   Cincinnati Outlaw Reds     1        0.6571429             NA
##  3              Boston Reds     3        0.6163020     0.07903104
##  4         Providence Grays     8        0.6092069     0.08552465
##  5  Chicago White Stockings    17        0.6090423     0.11726548
##  6 Cincinnati Red Stockings     8        0.5888868     0.06395065
##  7          Boston Red Caps     7        0.5790099     0.09764495
##  8         New York Yankees   104        0.5760731     0.06993827
##  9  Brooklyn Ward's Wonders     1        0.5757576             NA
## 10      Philadelphia Whites     3        0.5744543     0.09339407
## # ... with 129 more rows
</code></pre>

<hr />

<h2 id="final-notes-on-dplyr">Final notes on <em>dplyr</em></h2>

<ul>
<li>We&rsquo;ll be using <em>dplyr</em> all term long</li>
<li>Discussion today was fairly superficial</li>
<li>Discussion today was fast (especially at the end)</li>
<li>Verbs can help you gain fluency</li>
<li>There are also conditional and all-inclusive versions of <code>mutate</code>, <code>select</code>, and <code>summarize</code>.

<ul>
<li>For example <code>mutate_if(is.character, as.numeric)</code>, <code>select_if(is.numeric)</code>, etc. We&rsquo;ll talk about these more starting Thursday.</li>
</ul></li>
</ul>

<hr />

<h1 id="r-markdown-r-studio-projects">R Markdown &amp; R Studio Projects</h1>

<hr />

<h2 id="discussion">Discussion</h2>

<ul>
<li>What struggles are you having?</li>
<li>Have you tried getting a pdf to render?</li>
<li>How comfortable are you with it at this point?</li>
</ul>

<hr />

<h2 id="pop-quiz-sort-of">Pop Quiz (sort of)</h2>

<p>Discuss with your neighbor to come up with answers to the following:</p>

<ul>
<li>How do you specify a Level 1 header? Level 2? Level 3?</li>
<li>How would you create a bulleted list that includes indentations (nesting)? What about a numbered list?</li>
<li>What is a YAML and what are two basic pieces that are generally included in the YAML? Can you think of other things that might be included there?</li>
</ul>

<hr />

<h2 id="reminder-best-practices">Reminder - best practices</h2>

<ul>
<li>Always name your code chunks (you won&rsquo;t end up with a bunch of &ldquo;untitled_chunk&rdquo; files on your computer)

<ul>
<li>Don&rsquo;t include spaces in your chunk names</li>
<li>Keep code chunk names unique or rendering will fail</li>
</ul></li>
<li>Include lots of small chunks, rather than one big one

<ul>
<li>Helps you diagnose where an error in rendering is occuring, if one occurs</li>
</ul></li>
<li>Render frequently</li>
<li>Keep code chunks close to relevant text (helps you when you come back to it later)
(we&rsquo;ll discuss more chunk options, etc., Week 5)</li>
</ul>

<hr />

<h2 id="r-studio-projects">R Studio Projects</h2>

<ul>
<li>Struggles?</li>
<li>Think about working directories.</li>
<li>Keep everything in the project that you need for the analysis</li>
<li>Should have a new R Studio project for each project (homework, lab, final project, etc.)</li>
<li>Ask yourself regularly if you would be able to reproduce the work you&rsquo;ve done if you came into it with no history with the project.

<ul>
<li>If yes, good, if no, make changes until the answer is yes</li>
</ul></li>
</ul>

<hr />

<h2 id="for-next-time">For Next Time</h2>

<ul>
<li>Homework 1 due</li>
<li>Homework 2 assigned</li>
<li>We&rsquo;ll discuss importing data</li>
<li>Last minute questions?</li>
</ul>

      </article>

      <ul class="pager blog-pager">
        
        
          <li class="next">
            <a href="/page/classr/slides/w5p2/w5p2/" data-toggle="tooltip" data-placement="top" title="Tidy data, data viz, and summaries">Next Post &rarr;</a>
          </li>
        
      </ul>

      
        
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-www-dandersondata-com';
    var disqus_identifier = '\/page\/classr\/slides\/w2p1\/w2p1\/';
    var disqus_title = 'dplyr (and a bit of checking in)';
    var disqus_url = '\/page\/classr\/slides\/w2p1\/w2p1\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:daniela@uoregon.edu" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/DJAnderson07" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/DJAnderson_07" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/4959854/daniel-anderson" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="http://www.dandersondata.com">Daniel Anderson</a>
                      
          
          
          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="/">Data Science in Education</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.24.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>




  </body>
</html>

