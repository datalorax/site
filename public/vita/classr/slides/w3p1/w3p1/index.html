<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Intro to ggplot2 - Data Science in Education</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Daniel Anderson" />
  <meta name="description" content="em { font-style: italic }   strong { font-weight: bold; }  Agenda  Introduce the ggplot2 package  Note: There is a lot that we won&amp;rsquo;t cover today (it&amp;rsquo;s just an intro).
The ggplot2 package Today, we&amp;rsquo;ll primarily be covering the basics of the ggplot2 package. Much of this presentation is based on examples from the new ggplot2 book.
Part of the many reasons Hadley is a cool guy  (It&amp;rsquo;s no longer there, but if you want access to it let me know)" />

  <meta name="keywords" content="Data Science, Education, Data Visualization" />






<meta name="generator" content="Hugo 0.48" />


<link rel="canonical" href="/vita/classr/slides/w3p1/w3p1/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">







<link href="/dist/even.min.css?v=3.0.1" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">




<meta property="og:title" content="Intro to ggplot2" />
<meta property="og:description" content="em { font-style: italic }   strong { font-weight: bold; }  Agenda  Introduce the ggplot2 package  Note: There is a lot that we won&rsquo;t cover today (it&rsquo;s just an intro).
The ggplot2 package Today, we&rsquo;ll primarily be covering the basics of the ggplot2 package. Much of this presentation is based on examples from the new ggplot2 book.
Part of the many reasons Hadley is a cool guy  (It&rsquo;s no longer there, but if you want access to it let me know)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/vita/classr/slides/w3p1/w3p1/" />
<meta itemprop="name" content="Intro to ggplot2">
<meta itemprop="description" content="em { font-style: italic }   strong { font-weight: bold; }  Agenda  Introduce the ggplot2 package  Note: There is a lot that we won&rsquo;t cover today (it&rsquo;s just an intro).
The ggplot2 package Today, we&rsquo;ll primarily be covering the basics of the ggplot2 package. Much of this presentation is based on examples from the new ggplot2 book.
Part of the many reasons Hadley is a cool guy  (It&rsquo;s no longer there, but if you want access to it let me know)">



<meta itemprop="wordCount" content="2689">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Intro to ggplot2"/>
<meta name="twitter:description" content="em { font-style: italic }   strong { font-weight: bold; }  Agenda  Introduce the ggplot2 package  Note: There is a lot that we won&rsquo;t cover today (it&rsquo;s just an intro).
The ggplot2 package Today, we&rsquo;ll primarily be covering the basics of the ggplot2 package. Much of this presentation is based on examples from the new ggplot2 book.
Part of the many reasons Hadley is a cool guy  (It&rsquo;s no longer there, but if you want access to it let me know)"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">datalorax</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/talks/talks/">
        <li class="mobile-menu-item">Talks</li>
      </a><a href="/vita/vita/">
        <li class="mobile-menu-item">Vita</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">datalorax</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/talks/talks/">Talks</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/vita/vita/">Vita</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
  <div class="post-content">
      

<style>
em {
  font-style: italic
}
</style>

<style>
strong {
  font-weight: bold;
}
</style>

<h2 id="agenda">Agenda</h2>

<ul>
<li>Introduce the <em>ggplot2</em> package</li>
</ul>

<p><strong>Note:</strong> There is a <em>lot</em> that we won&rsquo;t cover today (it&rsquo;s just an intro).</p>

<hr />

<h2 id="the-ggplot2-package">The <em>ggplot2</em> package</h2>

<p>Today, we&rsquo;ll primarily be covering the basics of the <em>ggplot2</em> package. Much of this presentation is based on examples from the new <em>ggplot2</em> book.</p>

<p><img src="../assets/img/ggplotBook.png" alt="ggplotBook" /></p>

<hr />

<h2 id="part-of-the-many-reasons-hadley-is-a-cool-guy">Part of the many reasons Hadley is a cool guy</h2>

<div align = "left">
<img src = ../assets/img/freeggplot.png width = 1000 height = 500>
</div>

<p>(It&rsquo;s no longer there, but if you want access to it let me know)</p>

<hr />

<h2 id="other-resources">Other resources</h2>

<p>The <em>ggplot2</em> package is one of the most popular R packages. There are a plethora of resources to learn the syntax.</p>

<ul>
<li><p>Perhaps the most definitive, and indexes all the capabilities of ggplot2, along with multiple examples</p>

<ul>
<li><a href="http://docs.ggplot2.org/current/index.html#">http://docs.ggplot2.org/current/index.html#</a></li>
</ul></li>

<li><p>RStudio cheat sheet can also be helpful</p>

<ul>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf</a></li>
</ul></li>

<li><p>R Graphics Cookbook</p>

<ul>
<li><a href="http://www.cookbook-r.com/Graphs/">http://www.cookbook-r.com/Graphs/</a></li>
</ul></li>
</ul>

<hr />

<h2 id="components">Components</h2>

<p>Every <em>ggplot</em> plot has three components</p>

<ol>
<li>data

<ul>
<li>The data used to produce the plot</li>
</ul></li>
<li>aesthetic mappings

<ul>
<li>between variables and visual properties</li>
</ul></li>
<li>layer(s)

<ul>
<li>usually through the geom function to produce geometric shape to be rendered</li>
</ul></li>
</ol>

<hr />

<h2 id="basic-syntax">Basic syntax</h2>

<p><img src="../assets/img/ggplotBasicSyntax.png" alt="ggplotBasicSyntax" /></p>

<p>Note that Hadley recommends putting each <code>geom_XXX</code> on a separate line to ease clarity. I agree with this suggestion and will generally follow it, although the above does not. .</p>

<hr />

<h2 id="mpg-data">mpg data</h2>

<p>Very similar to the <em>mtcars</em> data, but with more cases and a few more interesting variables</p>

<pre><code class="language-r">library(ggplot2)
data(mpg)
head(mpg)
</code></pre>

<pre><code>## # A tibble: 6 x 11
##   manufacturer model displ  year   cyl      trans   drv   cty   hwy    fl
##          &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
## 1         audi    a4   1.8  1999     4   auto(l5)     f    18    29     p
## 2         audi    a4   1.8  1999     4 manual(m5)     f    21    29     p
## 3         audi    a4   2.0  2008     4 manual(m6)     f    20    31     p
## 4         audi    a4   2.0  2008     4   auto(av)     f    21    30     p
## 5         audi    a4   2.8  1999     6   auto(l5)     f    16    26     p
## 6         audi    a4   2.8  1999     6 manual(m5)     f    18    26     p
## # ... with 1 more variables: class &lt;chr&gt;
</code></pre>

<hr />

<h2 id="quick-example">Quick example</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point()
</code></pre>

<p><img src="../assets/fig/mpgEx1-1.png" alt="plot of chunk mpgEx1" /></p>

<hr />

<h2 id="quick-example-2">Quick example 2</h2>

<p>Note that the only thing that has changed here is the <code>geom</code></p>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_smooth()
</code></pre>

<p><img src="../assets/fig/mpgEx2-1.png" alt="plot of chunk mpgEx2" /></p>

<hr />

<h2 id="add-an-additional-layer">Add an additional layer</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()
</code></pre>

<p><img src="../assets/fig/mpgEx3-1.png" alt="plot of chunk mpgEx3" /></p>

<hr />

<h2 id="change-x-and-y-labels">Change x and y labels</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth() +
  xlab(&quot;Engine Displacement&quot;) + 
  ylab(&quot;Highway Miles Per Gallon&quot;)
</code></pre>

<p><img src="../assets/fig/mpgEx3_labs-1.png" alt="plot of chunk mpgEx3_labs" /></p>

<hr />

<h2 id="title">Title</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth() +
  ggtitle(&quot;Engine Size and Highway Miles Per Gallon&quot;)
</code></pre>

<p><img src="../assets/fig/mpgEx3_title-1.png" alt="plot of chunk mpgEx3_title" /></p>

<hr />

<h2 id="add-an-additional-aesthetic">Add an additional aesthetic</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy, color = class)) + 
  geom_point() 
</code></pre>

<p><img src="../assets/fig/mpgEx4-1.png" alt="plot of chunk mpgEx4" /></p>

<hr />

<h2 id="add-smooth-line-for-each-class">Add smooth line for each class</h2>

<h1 id="too-busy">Too busy</h1>

<p>Note the below spits out some warnings because of the sparsity of the data. I&rsquo;ve suppressed them here.</p>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy, color = class)) + 
  geom_point() +
  geom_smooth()
</code></pre>

<p><img src="../assets/fig/mpgEx5b-1.png" alt="plot of chunk mpgEx5b" /></p>

<hr />

<h2 id="remove-se">Remove SE</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy, color = class)) + 
  geom_point() +
  geom_smooth(se = FALSE)
</code></pre>

<p><img src="../assets/fig/mpgEx6b-1.png" alt="plot of chunk mpgEx6b" /></p>

<hr />

<h2 id="change-the-color-of-all-points">Change the color of all points</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point(color = &quot;purple&quot;) +
  geom_smooth(se = FALSE)
</code></pre>

<p><img src="../assets/fig/mpgEx7-1.png" alt="plot of chunk mpgEx7" /></p>

<hr />

<h1 id="can-you-guess-how-we-would-change-the-line-color">Can you guess how we would change the line color?</h1>

<hr />

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point(color = &quot;purple&quot;) +
  geom_smooth(se = FALSE, color = &quot;gray&quot;, size = 2, linetype = &quot;dashed&quot;)
</code></pre>

<p><img src="../assets/fig/mpgEx8-1.png" alt="plot of chunk mpgEx8" /></p>

<hr />

<p>Worth mentioning, traditional calls to line color/type/size also work</p>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point(color = &quot;purple&quot;) +
  geom_smooth(se = FALSE, col = &quot;gray&quot;, lwd = 2, lty = &quot;dashed&quot;)
</code></pre>

<p><img src="../assets/fig/mpgEx9-1.png" alt="plot of chunk mpgEx9" /></p>

<hr />

<h2 id="change-the-wiggliness-of-the-smoother">Change the &ldquo;wiggliness&rdquo; of the smoother</h2>

<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) + 
  geom_point(color = &quot;purple&quot;) +
  geom_smooth(span = 0.2)
</code></pre>

<p><img src="../assets/fig/mpgEx10-1.png" alt="plot of chunk mpgEx10" /></p>

<hr />

<h2 id="geoms-for-two-continuous-variables">Geoms for two continuous variables</h2>

<table>
<thead>
<tr>
<th align="left">Geoms</th>
<th align="left">Description</th>
<th align="left">Code</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">jitter</td>
<td align="left">Jitter points (to avoid overlapping)</td>
<td align="left">geom_jitter()</td>
</tr>

<tr>
<td align="left">point</td>
<td align="left">Plot points at each x&#124;y intersection</td>
<td align="left">geom_point()</td>
</tr>

<tr>
<td align="left">quantile</td>
<td align="left">Plot lines from quantile regression</td>
<td align="left">geom_quantile()</td>
</tr>

<tr>
<td align="left">rug</td>
<td align="left">Plot 1d scatterplot on margins (stripchart)</td>
<td align="left">geom_rug()</td>
</tr>

<tr>
<td align="left">smooth</td>
<td align="left">Plot a smoothing function (many smoothers available)</td>
<td align="left">geom_smooth()</td>
</tr>

<tr>
<td align="left">text</td>
<td align="left">Add text annotations</td>
<td align="left">geom_text()</td>
</tr>

<tr>
<td align="left">bin2d</td>
<td align="left">Bin observations that are close together and color according the density</td>
<td align="left">geom_bin2d()</td>
</tr>

<tr>
<td align="left">density2d</td>
<td align="left">Contour lines of the data density</td>
<td align="left">geom_density2d()</td>
</tr>

<tr>
<td align="left">hex</td>
<td align="left">Hexagonal bins of data colored according to their density</td>
<td align="left">geom_hex()</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="guided-practice">Guided practice</h2>

<ul>
<li>Load the <em>ggplot2</em> package.</li>
<li>Load the diamonds dataset with <code>data(diamonds)</code></li>
<li>Set and store the data and aesthetics, in an object <code>p</code>, using the following code</li>
</ul>

<pre><code class="language-r">library(ggplot2)
data(diamonds)
p &lt;- ggplot(diamonds, aes(carat, price))
</code></pre>

<ul>
<li>Print <code>p</code>. What do you see?</li>
<li>Explore different geoms, with <code>p + geom_XXX()</code>(some geoms, such as <code>geom_hex()</code> require additional package(s)). For example, a basic scatterplot could be produced with</li>
</ul>

<pre><code class="language-r">p + geom_point()
</code></pre>

<ul>
<li>Add at least one additional layer (i.e., produce a plot with at least two layers)</li>
</ul>

<hr />

<h2 id="some-possibilities">Some possibilities</h2>

<pre><code class="language-r">p + geom_point()
</code></pre>

<p><img src="../assets/fig/guidedp1_3a-1.png" alt="plot of chunk guidedp1_3a" /></p>

<hr />

<h2 id="probably-better">Probably better</h2>

<pre><code class="language-r">p + geom_hex()
</code></pre>

<p><img src="../assets/fig/guidedp1_3b-1.png" alt="plot of chunk guidedp1_3b" /></p>

<hr />

<h2 id="another-similar-alternative">Another similar alternative</h2>

<pre><code class="language-r">p + geom_bin2d()
</code></pre>

<p><img src="../assets/fig/guidedp1_3c-1.png" alt="plot of chunk guidedp1_3c" /></p>

<hr />

<h2 id="yet-another-alternative">Yet another alternative</h2>

<pre><code class="language-r">p + geom_point(alpha = 0.01) + 
  geom_density2d(color = &quot;red&quot;)
</code></pre>

<p><img src="../assets/fig/guidedp1_3d-1.png" alt="plot of chunk guidedp1_3d" /></p>

<hr />

<h2 id="quantiles">Quantiles</h2>

<p>Defaults to the 25th, 50th, and 75th percentiles</p>

<pre><code class="language-r">p + geom_quantile()
</code></pre>

<p><img src="../assets/fig/guidedp1_4-1.png" alt="plot of chunk guidedp1_4" /></p>

<hr />

<h2 id="quantiles-1">Quantiles</h2>

<p>Change the quantiles to deciles (from 10th to 90th)</p>

<pre><code class="language-r">p + geom_quantile(quantiles = seq(0.1, 0.9, 0.1))
</code></pre>

<p><img src="../assets/fig/guidedp1_5-1.png" alt="plot of chunk guidedp1_5" /></p>

<hr />

<h2 id="add-an-extra-layer">Add an extra layer</h2>

<pre><code class="language-r">p + geom_point() + 
  geom_rug() + 
  geom_smooth()
</code></pre>

<p><img src="../assets/fig/guidedp1_6-1.png" alt="plot of chunk guidedp1_6" /></p>

<hr />

<h2 id="color-by-cut">Color by cut</h2>

<p>(Note: My color scheme will likel be different than yours because I have the development version installed. Use <code>devtools::install_github(&quot;tidyverse/ggplot2&quot;))</code> if you want your to match mine.)</p>

<pre><code class="language-r">p2cut &lt;- ggplot(diamonds, aes(carat, price, color = cut))
p2cut + geom_point()
</code></pre>

<p><img src="../assets/fig/guidedp1_7-1.png" alt="plot of chunk guidedp1_7" /></p>

<hr />

<h2 id="color-by-color">Color by color</h2>

<pre><code class="language-r">p2color &lt;- ggplot(diamonds, aes(carat, price, color = color))
p2color + geom_point()
</code></pre>

<p><img src="../assets/fig/guidedp1_8-1.png" alt="plot of chunk guidedp1_8" /></p>

<hr />

<h2 id="color-by-clarity">Color by clarity</h2>

<pre><code class="language-r">p2clarity &lt;- ggplot(diamonds, aes(carat, price, color = clarity))
p2clarity + geom_point()
</code></pre>

<p><img src="../assets/fig/guidedp1_9-1.png" alt="plot of chunk guidedp1_9" /></p>

<hr />

<h2 id="geoms-one-variable">geoms: One variable</h2>

<table>
<thead>
<tr>
<th align="left">Geoms</th>
<th align="left">Description</th>
<th align="left">Code</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">area</td>
<td align="left">Filled area plot</td>
<td align="left">geom_area(stat = &ldquo;bin&rdquo;)</td>
</tr>

<tr>
<td align="left">density</td>
<td align="left">Density plot</td>
<td align="left">geom_density()</td>
</tr>

<tr>
<td align="left">dotplot</td>
<td align="left">Stacked dotplot, with each dot representing an observation</td>
<td align="left">geom_dotplot()</td>
</tr>

<tr>
<td align="left">polygon of Frequencies</td>
<td align="left">Polygon of frequencies</td>
<td align="left">geom_freqpoly</td>
</tr>

<tr>
<td align="left">histogram</td>
<td align="left">Standard histogram</td>
<td align="left">geom_histogram</td>
</tr>

<tr>
<td align="left">barplot</td>
<td align="left">Standard barchart</td>
<td align="left">geom_bar</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="area-plot">Area plot</h2>

<pre><code class="language-r">price &lt;- ggplot(diamonds, aes(price)) 
price + geom_area(stat = &quot;bin&quot;)
</code></pre>

<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>

<p><img src="../assets/fig/geom_area-1.png" alt="plot of chunk geom_area" /></p>

<hr />

<h1 id="frequency-polygons">Frequency polygons</h1>

<pre><code class="language-r">price + geom_freqpoly()
</code></pre>

<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>

<p><img src="../assets/fig/geom_freqPoly-1.png" alt="plot of chunk geom_freqPoly" /></p>

<hr />

<h2 id="evaluate-frequencies-by-cut">Evaluate frequencies by <em>cut</em></h2>

<pre><code class="language-r">price2 &lt;- ggplot(diamonds, aes(price, color = cut))
price2 + geom_freqpoly(bins = 50)
</code></pre>

<p><img src="../assets/fig/geom_freqPolyClarity-1.png" alt="plot of chunk geom_freqPolyClarity" /></p>

<hr />

<h2 id="histograms">Histograms</h2>

<pre><code class="language-r">price + geom_histogram()
</code></pre>

<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>

<p><img src="../assets/fig/geom_histogram1-1.png" alt="plot of chunk geom_histogram1" /></p>

<hr />

<h1 id="change-binwidth">Change binwidth</h1>

<pre><code class="language-r">price + geom_histogram(binwidth = 5)
</code></pre>

<p><img src="../assets/fig/geom_histogram2-1.png" alt="plot of chunk geom_histogram2" /></p>

<hr />

<h2 id="barplots">Barplots</h2>

<pre><code class="language-r">ggplot(mpg, aes(trans)) + 
  geom_bar()
</code></pre>

<p><img src="../assets/fig/barplot1-1.png" alt="plot of chunk barplot1" /></p>

<hr />

<h1 id="plotting-categorical-variables">Plotting categorical variables</h1>

<hr />

<h2 id="boxplots">boxplots</h2>

<p>Note that the categorical variable must be categorical or declared as a factor</p>

<pre><code class="language-r">bp &lt;- ggplot(mpg, aes(drv, hwy))
bp + geom_boxplot()
</code></pre>

<p><img src="../assets/fig/boxplots1-1.png" alt="plot of chunk boxplots1" /></p>

<hr />

<h2 id="stripcharts">stripcharts</h2>

<pre><code class="language-r">bp + geom_point()
</code></pre>

<p><img src="../assets/fig/stripcharts1-1.png" alt="plot of chunk stripcharts1" /></p>

<pre><code class="language-r">bp + geom_jitter()
</code></pre>

<p><img src="../assets/fig/jitterchart1-1.png" alt="plot of chunk jitterchart1" /></p>

<hr />

<h2 id="control-the-amount-of-jittering">Control the amount of jittering</h2>

<pre><code class="language-r">bp + geom_jitter(width = 0.3, height = 0)
</code></pre>

<p><img src="../assets/fig/jitter-1.png" alt="plot of chunk jitter" /></p>

<hr />

<h2 id="useful-together">Useful together</h2>

<pre><code class="language-r">bp + geom_boxplot() + 
  geom_jitter(width = 0.3, height = 0)
</code></pre>

<p><img src="../assets/fig/boxplotJitter-1.png" alt="plot of chunk boxplotJitter" /></p>

<hr />

<h2 id="usually-better-violin-plots">Usually better: Violin plots</h2>

<pre><code class="language-r">bp + geom_violin()
</code></pre>

<p><img src="../assets/fig/violin-1.png" alt="plot of chunk violin" /></p>

<hr />

<h2 id="and-can-also-be-combined-with-data">And can also be combined with data</h2>

<pre><code class="language-r">bp + geom_violin() + 
  geom_jitter(width = 0.3, height = 0)
</code></pre>

<p><img src="../assets/fig/violin_data-1.png" alt="plot of chunk violin_data" /></p>

<hr />

<h2 id="ridgeline-plots-also-known-as-joy-plots">ridgeline plots (also known as joy plots)</h2>

<pre><code class="language-r">#install.packages(&quot;ggridges&quot;)
library(ggridges)
ggplot(mpg, aes(hwy, drv)) + # x/y reveresed from boxplots/violin plots
  geom_density_ridges()
</code></pre>

<p><img src="../assets/fig/joyplots-1.png" alt="plot of chunk joyplots" /></p>

<hr />

<h2 id="lots-of-levels">Lots of levels</h2>

<p>Still works pretty well</p>

<pre><code class="language-r">ggplot(mpg, aes(hwy, model)) +
  geom_density_ridges(fill = &quot;cornflowerblue&quot;)
</code></pre>

<p><img src="../assets/fig/joyplots2-1.png" alt="plot of chunk joyplots2" /></p>

<hr />

<h1 id="faceting">Faceting</h1>

<hr />

<h2 id="produce-separate-plots-according-to-a-specific-variable">Produce separate plots according to a specific variable</h2>

<p>Back to the mpg dataset:
* Produce a separate plot of the relation between engine size and highway miles per gallon for each car type.</p>

<pre><code class="language-r">hwy &lt;- ggplot(mpg, aes(displ, hwy))
hwy + geom_point() + 
  facet_wrap(~class)
</code></pre>

<p><img src="../assets/fig/faceting1-1.png" alt="plot of chunk faceting1" /></p>

<hr />

<h2 id="add-a-linear-function-to-each-plot">Add a linear function to each plot</h2>

<pre><code class="language-r">hwy + geom_point() + 
  geom_smooth(method = &quot;lm&quot;) + 
  facet_wrap(~class)
</code></pre>

<p><img src="../assets/fig/faceting2-1.png" alt="plot of chunk faceting2" /></p>

<hr />

<h2 id="example-with-growth-modeling">Example with growth modeling</h2>

<p>The data</p>

<pre><code class="language-r"># Loaded earlier
head(d, n = 15)
</code></pre>

<pre><code>##         SID   TID ScID    Months RIT
## 2873 332347 30867 1117 8.7387097 192
## 355  400047 69957 1077 1.6387097 182
## 387  400047 69957 1077 4.3225806 179
## 162  400047 69957 1077 8.9677419 191
## 648  400277 69957 1077 1.2053763 196
## 230  400277 69957 1077 4.3225806 197
## 780  400277 69957 1077 8.9677419 209
## 8878 400597 32247 1257 0.9720430 197
## 8914 400597 32247 1257 4.2258065 202
## 8790 400597 32247 1257 8.3053763 211
## 348  400807 28767 1077 1.3387097 178
## 168  400807 28767 1077 4.1935484 190
## 803  400807 28767 1077 8.8053763 178
## 1150 401227 32787 1087 0.9387097 187
## 1269 401227 32787 1087 4.1612903 192
</code></pre>

<hr />

<h2 id="random-sampling">Random sampling</h2>

<p>There are far too many students to plot every one. Instead, we&rsquo;ll take a random sample of 16 (a couple of times)</p>

<pre><code class="language-r">set.seed(100)
samp1 &lt;- d[d$SID %in% sample(levels(d$SID), 16), ]
samp2 &lt;- d[d$SID %in% sample(levels(d$SID), 16), ]
samp3 &lt;- d[d$SID %in% sample(levels(d$SID), 16), ]
head(samp1)
</code></pre>

<pre><code>##         SID   TID ScID    Months RIT
## 2803 503177 30867 1117 1.1053763 198
## 2829 503177 30867 1117 4.3548387 202
## 2761 503177 30867 1117 8.7387097 214
## 9275 516037 34167 1267 0.9387097 214
## 9191 516037 34167 1267 4.1612903 205
## 9614 516037 34167 1267 8.5720430 209
</code></pre>

<hr />

<h2 id="sample-1">Sample 1</h2>

<pre><code class="language-r">ggplot(samp1, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot1-1.png" alt="plot of chunk DissPLot1" /></p>

<hr />

<h2 id="sample-2">Sample 2</h2>

<pre><code class="language-r">ggplot(samp2, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot2-1.png" alt="plot of chunk DissPLot2" /></p>

<hr />

<h2 id="sample-3">Sample 3</h2>

<pre><code class="language-r">ggplot(samp3, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot3-1.png" alt="plot of chunk DissPLot3" /></p>

<hr />

<h2 id="alternative-connect-the-dots">Alternative: Connect the dots</h2>

<p>Note that <code>group</code> is specified in the aesthetic now.</p>

<pre><code class="language-r">ggplot(samp1, aes(Months, RIT, group = SID)) + 
  geom_point() + 
  geom_line()
</code></pre>

<p><img src="../assets/fig/connectDots-1.png" alt="plot of chunk connectDots" /></p>

<hr />

<p>Or, put all lines in a single plot</p>

<pre><code class="language-r">ggplot(samp1, aes(Months, RIT, group = SID)) + 
  geom_point() + 
  geom_smooth(se = FALSE, span = 2)
</code></pre>

<p><img src="../assets/fig/smoothDots-1.png" alt="plot of chunk smoothDots" /></p>

<hr />

<h2 id="what-happens-if-you-forget-to-specify-the-group">What happens if you forget to specify the group?</h2>

<pre><code class="language-r">ggplot(samp1, aes(Months, RIT)) + 
  geom_point() + 
  geom_line()
</code></pre>

<p><img src="../assets/fig/connectDotsError-1.png" alt="plot of chunk connectDotsError" /></p>

<hr />

<h2 id="how-bad-is-the-nonlinearity-really">How bad is the nonlinearity, really?</h2>

<p>Overlay a linear trend</p>

<pre><code class="language-r">ggplot(samp1, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot4-1.png" alt="plot of chunk DissPLot4" /></p>

<hr />

<pre><code class="language-r">ggplot(samp2, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot5-1.png" alt="plot of chunk DissPLot5" /></p>

<hr />

<pre><code class="language-r">ggplot(samp3, aes(Months, RIT)) + 
  geom_point() + 
  geom_smooth(color = &quot;red&quot;, span = 2, se = FALSE) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + facet_wrap(~SID)
</code></pre>

<p><img src="../assets/fig/DissPLot6-1.png" alt="plot of chunk DissPLot6" /></p>

<hr />

<h2 id="a-few-notes">A few notes</h2>

<ul>
<li>Equivalent plots could be produced at other levels (in this case, the classroom or school levels)</li>
<li>The previous plots did produce some warnings (only 3 points with the LOESS)</li>
</ul>

<pre><code class="language-r">lfit &lt;- loess(RIT ~ Months, data = samp1, subset = SID == 503177, span = 2)
</code></pre>

<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : span too small. fewer data values than degrees of freedom.
</code></pre>

<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : Chernobyl! trL&gt;n 3

## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : Chernobyl! trL&gt;n 3
</code></pre>

<pre><code>## Warning in sqrt(sum.squares/one.delta): NaNs produced
</code></pre>

<hr />

<h2 id="different-faceting">Different faceting</h2>

<p><code>facet_wrap</code> vs <code>facet_grid</code></p>

<div align = "center">
<img src = ../assets/img/faceting.png width = 800 height = 400>
</div>

<hr />

<h2 id="options-for-facet-wrap">Options for <code>facet_wrap</code></h2>

<p>Change the number of columns</p>

<pre><code class="language-r">f &lt;- ggplot(mpg, aes(displ, hwy)) + geom_point()
f + facet_wrap(~class, ncol = 4)
</code></pre>

<p><img src="../assets/fig/faceting3-1.png" alt="plot of chunk faceting3" /></p>

<hr />

<p>Change the direction plots are produced</p>

<pre><code class="language-r">f + facet_wrap(~class, ncol = 4, dir = &quot;v&quot;)
</code></pre>

<p><img src="../assets/fig/faceting4-1.png" alt="plot of chunk faceting4" /></p>

<hr />

<h2 id="facet-grid">Facet Grid</h2>

<p>Note that <code>.</code> must be included on the left, if only a single variable is used</p>

<pre><code class="language-r">f + facet_grid(. ~ cyl)
</code></pre>

<p><img src="../assets/fig/facetGrid1-1.png" alt="plot of chunk facetGrid1" /></p>

<hr />

<pre><code class="language-r">f + facet_grid(drv ~ .)
</code></pre>

<p><img src="../assets/fig/facetGrid2-1.png" alt="plot of chunk facetGrid2" /></p>

<hr />

<h2 id="two-variables">Two variables</h2>

<pre><code class="language-r">f + facet_grid(drv ~ cyl)
</code></pre>

<p><img src="../assets/fig/facetGrid3-1.png" alt="plot of chunk facetGrid3" /></p>

<hr />

<h2 id="two-variables-1">Two variables</h2>

<p>(The LOESS estimator spits out warnings here again)</p>

<pre><code class="language-r">f + geom_smooth(span = 2) + 
  facet_grid(drv ~ cyl)
</code></pre>

<p><img src="../assets/fig/facetGrid4-1.png" alt="plot of chunk facetGrid4" /></p>

<hr />

<h2 id="scales-with-faceting">Scales with faceting</h2>

<p>Allow all scales to be produced independently (freely)</p>

<pre><code class="language-r">f + facet_wrap(~ cyl, scales = &quot;free&quot;)
</code></pre>

<p><img src="../assets/fig/facetScales1-1.png" alt="plot of chunk facetScales1" /></p>

<hr />

<p>Free y-axis scale, fixed x</p>

<pre><code class="language-r">f + facet_wrap(~ cyl, scales = &quot;free_y&quot;)
</code></pre>

<p><img src="../assets/fig/facetScales2-1.png" alt="plot of chunk facetScales2" /></p>

<hr />

<p>Free x-axis scale, fixed y</p>

<pre><code class="language-r">f + facet_wrap(~ cyl, scales = &quot;free_x&quot;)
</code></pre>

<p><img src="../assets/fig/facetScales3-1.png" alt="plot of chunk facetScales3" /></p>

<hr />

<p>Change spacing with <code>facet_grid</code></p>

<pre><code class="language-r">f + facet_grid(drv ~ cyl, scales = &quot;free&quot;, space = &quot;free&quot;)
</code></pre>

<p><img src="../assets/fig/facetGrid5-1.png" alt="plot of chunk facetGrid5" /></p>

<hr />

<h2 id="faceting-vs-grouping">Faceting vs Grouping</h2>

<pre><code class="language-r">ggplot(mpg, 
  aes(displ, hwy, color = factor(drv))) + 
  geom_point()
</code></pre>

<p><img src="../assets/fig/facetGrouping1-1.png" alt="plot of chunk facetGrouping1" /></p>

<pre><code class="language-r">ggplot(mpg, aes(displ, hwy)) + 
  geom_point() + 
  facet_wrap(~ drv)
</code></pre>

<p><img src="../assets/fig/facetGrouping2-1.png" alt="plot of chunk facetGrouping2" /></p>

<hr />

<h2 id="guided-practice-if-time-allows">Guided practice (if time allows)</h2>

<p>You can view the probability densities of diamond price by cut with the following code.</p>

<pre><code class="language-r">base &lt;- ggplot(diamonds, aes(price, color = cut))
base + geom_density()
</code></pre>

<ul>
<li>Use faceting to view the densities by <em>clarity</em>.</li>
<li>Modify the code to group by <em>clarity</em> and facet by <em>cut</em>. Which do you
prefer?</li>
</ul>

<p>You can view the relation between <em>price</em> and <em>carat</em> with the following code</p>

<pre><code class="language-r">ggplot(diamonds, aes(carat, price)) + geom_point()
</code></pre>

<ul>
<li>Modify the code so the points are colored according to their color.</li>
<li>Use faceting to produce separate plots for each color.</li>
</ul>

<hr />

<p>Use faceting to view the densities by <em>clarity</em>.</p>

<pre><code class="language-r">base &lt;- ggplot(diamonds, aes(price, color = cut))
base + geom_density() + facet_wrap(~ clarity)
</code></pre>

<p><img src="../assets/fig/guidedp2_4-1.png" alt="plot of chunk guidedp2_4" /></p>

<hr />

<p>Modify the code to group by <em>clarity</em> and facet by <em>cut</em>.</p>

<pre><code class="language-r">base2 &lt;- ggplot(diamonds, aes(price, color = clarity))
base2 + geom_density() + 
  facet_wrap(~ cut)
</code></pre>

<p><img src="../assets/fig/guidedp2_5-1.png" alt="plot of chunk guidedp2_5" /></p>

<hr />

<p>Modify the code so the points are colored according to their color.</p>

<pre><code class="language-r">ggplot(diamonds, aes(carat, price, color = color)) + 
  geom_point()
</code></pre>

<p><img src="../assets/fig/guidedp2_6-1.png" alt="plot of chunk guidedp2_6" /></p>

<hr />

<p>Use faceting to produce separate plots for each color.</p>

<pre><code class="language-r">ggplot(diamonds, aes(carat, price)) + 
  geom_point() + 
  facet_wrap(~ color)
</code></pre>

<p><img src="../assets/fig/guidedp2_7-1.png" alt="plot of chunk guidedp2_7" /></p>

<hr />

<h1 id="themes">Themes</h1>

<hr />

<h2 id="overview-of-themes">Overview of themes</h2>

<ul>
<li>Themes do not change how the data are rendered</li>
<li>Only change visual properties</li>
<li>Many built-in themes

<ul>
<li>Even more available through extension packages (specifically <em>ggthemes</em>)</li>
</ul></li>
<li>Fully customizable (though the syntax becomes lengthier)</li>
</ul>

<hr />

<h2 id="theme-gray-default">theme_gray (default)</h2>

<pre><code class="language-r">baseP &lt;- ggplot(economics, aes(date, unemploy)) + geom_line()
baseP + theme_gray()
</code></pre>

<p><img src="../assets/fig/theme_gray-1.png" alt="plot of chunk theme_gray" /></p>

<hr />

<h2 id="theme-bw">theme_bw</h2>

<pre><code class="language-r">baseP + theme_bw()
</code></pre>

<p><img src="../assets/fig/theme_bw-1.png" alt="plot of chunk theme_bw" /></p>

<hr />

<h2 id="theme-classic">theme_classic</h2>

<pre><code class="language-r">baseP + theme_classic()
</code></pre>

<p><img src="../assets/fig/theme_classic-1.png" alt="plot of chunk theme_classic" /></p>

<hr />

<h2 id="theme-dark">theme_dark</h2>

<pre><code class="language-r">baseP + theme_dark()
</code></pre>

<p><img src="../assets/fig/theme_dark-1.png" alt="plot of chunk theme_dark" /></p>

<hr />

<h2 id="theme-minimal">theme_minimal</h2>

<pre><code class="language-r">baseP + theme_minimal()
</code></pre>

<p><img src="../assets/fig/theme_minimal-1.png" alt="plot of chunk theme_minimal" /></p>

<hr />

<h2 id="further-customization">Further customization</h2>

<ul>
<li>See <a href="http://docs.ggplot2.org/dev/vignettes/themes.html">http://docs.ggplot2.org/dev/vignettes/themes.html</a></li>
<li>See <em>ggplot2</em> book, Chapter 8</li>
</ul>

<p><br>
<strong>Take Home Message:</strong> If you want it to look a certain way, you can do it (essentially nothing is impossible). Often there are others who have developed themes that will be close to what you want, which is easier than developing your own theme (although that can be rewarding in its own right).</p>

<hr />

<h2 id="wrap-up">Wrap-up</h2>

<h1 id="common-things-people-trip-up-on">Common things people trip up on</h1>

<ul>
<li><code>aes()</code>? When  to put things inside versus outside? Where to put <code>aes()</code>?</li>
<li>Categorical versus numerical data</li>
<li>Fill versus color - particularly with barcharts and boxplots.</li>
</ul>

<hr />

<h2 id="wrong-spot">Wrong spot!</h2>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(aes(color = &quot;purple&quot;))
</code></pre>

<p><img src="../assets/fig/aes_wrong1-1.png" alt="plot of chunk aes_wrong1" /></p>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(color = trans)
</code></pre>

<pre><code>## Error in layer(data = data, mapping = mapping, stat = stat, geom = GeomPoint, : object 'trans' not found
</code></pre>

<hr />

<h2 id="correct-spot">Correct spot</h2>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(color = &quot;purple&quot;)
</code></pre>

<p><img src="../assets/fig/aes_right1-1.png" alt="plot of chunk aes_right1" /></p>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(aes(color = trans))
</code></pre>

<p><img src="../assets/fig/aes_right2-1.png" alt="plot of chunk aes_right2" /></p>

<hr />

<h2 id="categorical-versus-numerical-data">Categorical versus numerical data</h2>

<h1 id="oops">Oops</h1>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(aes(color = cyl))
</code></pre>

<p><img src="../assets/fig/integer_data-1.png" alt="plot of chunk integer_data" /></p>

<h1 id="there-we-go">There we go&hellip;</h1>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy)) +
  geom_point(aes(color = factor(cyl)))
</code></pre>

<p><img src="../assets/fig/factor_data-1.png" alt="plot of chunk factor_data" /></p>

<hr />

<h2 id="fill-versus-color">Fill versus color</h2>

<pre><code class="language-r">ggplot(mpg, aes(trans, color = drv)) +
  geom_bar()
</code></pre>

<p><img src="../assets/fig/col-1.png" alt="plot of chunk col" /></p>

<pre><code class="language-r">ggplot(mpg, aes(trans, fill = drv)) +
  geom_bar()
</code></pre>

<p><img src="../assets/fig/fill-1.png" alt="plot of chunk fill" /></p>

<hr />

<h2 id="plot-side-by-side">plot side-by-side</h2>

<pre><code class="language-r">ggplot(mpg, aes(trans, fill = drv)) +
  geom_bar(position = &quot;dodge&quot;)
</code></pre>

<p><img src="../assets/fig/fill_dodge-1.png" alt="plot of chunk fill_dodge" /></p>

<hr />

<h1 id="exploratory-versus-model-based-plotting">Exploratory versus model-based plotting</h1>

<hr />

<h2 id="underlying-theory">Underlying theory</h2>

<ul>
<li><em>ggplot2</em> is optimized for speed in exploratory plotting.</li>
<li>Make &ldquo;ugly&rdquo; plots when exploring, but take the time to beautify them for publication</li>
<li>Model-based plotting is essentially confirmatory, but can help you understand and communicate the results better.</li>
</ul>

<hr />

<h2 id="load-and-tidy-seda-data">Load and tidy SEDA Data</h2>

<table>
<thead>
<tr>
<th align="right">leaid</th>
<th align="left">leaname</th>
<th align="right">fips</th>
<th align="left">stateabb</th>
<th align="right">year</th>
<th align="right">grade</th>
<th align="left">subject</th>
<th align="right">time</th>
<th align="right">mean</th>
<th align="right">se</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">100002</td>
<td align="left">ALABAMA YOUTH SERVICES</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2009</td>
<td align="right">8</td>
<td align="left">ela</td>
<td align="right">5</td>
<td align="right">210.5474</td>
<td align="right">6.723581</td>
</tr>

<tr>
<td align="right">100002</td>
<td align="left">ALABAMA YOUTH SERVICES</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2011</td>
<td align="right">8</td>
<td align="left">ela</td>
<td align="right">5</td>
<td align="right">231.6601</td>
<td align="right">6.741922</td>
</tr>

<tr>
<td align="right">100002</td>
<td align="left">ALABAMA YOUTH SERVICES</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2012</td>
<td align="right">8</td>
<td align="left">ela</td>
<td align="right">5</td>
<td align="right">226.1813</td>
<td align="right">6.657756</td>
</tr>

<tr>
<td align="right">100005</td>
<td align="left">ALBERTVILLE CITY</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2009</td>
<td align="right">3</td>
<td align="left">ela</td>
<td align="right">0</td>
<td align="right">204.4659</td>
<td align="right">2.747565</td>
</tr>

<tr>
<td align="right">100005</td>
<td align="left">ALBERTVILLE CITY</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2009</td>
<td align="right">4</td>
<td align="left">ela</td>
<td align="right">1</td>
<td align="right">207.4045</td>
<td align="right">2.939638</td>
</tr>

<tr>
<td align="right">100005</td>
<td align="left">ALBERTVILLE CITY</td>
<td align="right">1</td>
<td align="left">AL</td>
<td align="right">2009</td>
<td align="right">5</td>
<td align="left">ela</td>
<td align="right">2</td>
<td align="right">216.8594</td>
<td align="right">2.599224</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="lm-based-plot"><code>lm</code>-based plot</h2>

<p>If we fit a model like <code>lm(mean ~ time, data = td)</code>, then we can actually visualize this without even fitting the model, using <code>ggplot</code></p>

<pre><code class="language-r">ggplot(td, aes(time, mean)) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;)
</code></pre>

<p><img src="../assets/fig/lin_mod_vis_seda-1.png" alt="plot of chunk lin_mod_vis_seda" /></p>

<hr />

<h2 id="lm-based-plot-continued"><code>lm</code>-based plot (continued)</h2>

<p>Or perhaps we&rsquo;re interested in separate slopes for reading and math.</p>

<pre><code class="language-r">ggplot(td, aes(time, mean, color = factor(subject))) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;)
</code></pre>

<p><img src="../assets/fig/lin_mod_vis_by_sub_seda1-1.png" alt="plot of chunk lin_mod_vis_by_sub_seda1" /></p>

<pre><code class="language-r">ggplot(td, aes(time, mean)) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~subject)
</code></pre>

<p><img src="../assets/fig/lin_mod_vis_by_sub_seda2-1.png" alt="plot of chunk lin_mod_vis_by_sub_seda2" /></p>

<hr />

<h2 id="model-output-plotting">Model-output plotting</h2>

<p>While the previous plots are basically model-based plots, they can also be  exploratory, and often we want to plot results from the model. As mentioned last time, the <em>broom</em> package can help.</p>

<pre><code class="language-r">m &lt;- lm(mean ~ stateabb, data = td)
library(broom)
tidy_m &lt;- tidy(m, conf.int = TRUE)
head(tidy_m)
</code></pre>

<pre><code>##          term     estimate std.error   statistic       p.value   conf.low
## 1 (Intercept) 233.38152609 0.5341304 436.9373381  0.000000e+00 232.334648
## 2  stateabbAL   3.13844765 0.6010544   5.2215700  1.774676e-07   1.960400
## 3  stateabbAR   3.57728925 0.5698254   6.2778695  3.434620e-10   2.460450
## 4  stateabbAZ   0.09975552 0.5951292   0.1676199  8.668823e-01  -1.066678
## 5  stateabbCA  -2.71381607 0.5493784  -4.9397938  7.822482e-07  -3.790580
## 6  stateabbCO  17.70583750 0.6075348  29.1437401 1.328560e-186  16.515089
##    conf.high
## 1 234.428404
## 2   4.316495
## 3   4.694129
## 4   1.266190
## 5  -1.637052
## 6  18.896586
</code></pre>

<hr />

<pre><code class="language-r">ggplot(tidy_m[-1, ], aes(estimate, term, color = term)) +
  geom_point() +
    geom_errorbarh(aes(xmin = conf.low, xmax = conf.high)) +
    geom_vline(xintercept = 0)
</code></pre>

<p><img src="../assets/fig/coef_plot-1.png" alt="plot of chunk coef_plot" /></p>

  </div>
</article>
        </div>
        
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'http-www-dandersondata-com';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:daniela@uoregon.edu" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/users/4959854/daniel-anderson" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/datalorax_" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/datalorax" class="iconfont icon-github" title="github"></a>
  <a href="/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme based on 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    
      2017 - 
    2019
    <span class="author">Daniel Anderson</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>
<script type="text/javascript" src="/dist/even.min.js?v=3.0.1"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>








</body>
</html>
